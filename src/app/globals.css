/* src/app/globals.css */

/* Brand & theme tweaks */
:root {
  /* keep your brand color */
  --brand: #2563eb; /* blue-600 vibe */
}

/* Bootstrap gradient background for the whole page */
html, body {
  height: 100%;
  /* avoid accidental horizontal scroll when sidebar toggles */
  overflow-x: hidden;
}

/* Make the document a column flex so footer doesn't push full-height pages off-screen */
body {
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  /* replicate the soft slateâ†’white gradient */
  background: linear-gradient(to bottom, #f8fafc 0%, #ffffff 60%);
  /* text color aligns with Bootstrap's default body color */
  color: var(--bs-body-color);
}

/* Dark mode background gradient and minor tweaks */
[data-bs-theme="dark"] body {
  background: linear-gradient(to bottom, #0b1220 0%, #0e1626 60%);
}

/* Primary button tint to your brand */
.btn-primary {
  background-color: var(--brand);
  border-color: var(--brand);
}
.btn-primary:hover,
.btn-primary:focus {
  filter: brightness(0.95);
}

/* Card and surface styling adapt to Bootstrap variables */
.border { border-color: var(--bs-border-color) !important; }
.bg-white { background-color: var(--bs-body-bg) !important; }
.bg-body-tertiary { background-color: var(--bs-tertiary-bg) !important; }
.shadow-sm { box-shadow: var(--bs-box-shadow-sm) !important; }

/* Sidebar transitions */
/* Sidebar + shell layout (flex) to avoid overlap/stacking issues */
.sidebar {
  transition: flex-basis 0.25s ease, width 0.25s ease, box-shadow 0.25s ease;
  background-color: #ffffff;
}
[data-bs-theme="dark"] .sidebar { background-color: var(--bs-body-bg); }

.sidebar .nav-link {
  display: flex;
  align-items: center;
  white-space: nowrap;
  color: var(--bs-body-color);
  border-radius: 0.5rem;
}
/* Ensure consistent horizontal inset with brand */
.sidebar .nav-link { padding-left: 1rem; padding-right: 1rem; }

.sidebar .nav-link:hover {
  background-color: rgba(2, 6, 23, 0.04);
  color: var(--bs-body-color);
}

.sidebar .nav-link.active {
  background-color: rgba(37, 99, 235, 0.12);
  color: var(--brand);
  font-weight: 600;
}
[data-bs-theme="dark"] .sidebar .nav-link.active {
  background-color: rgba(37, 99, 235, 0.18);
}

/* Improve dark mode link readability */
[data-bs-theme="dark"] .sidebar .nav-link:not(.active) {
  color: var(--bs-secondary-color);
}
[data-bs-theme="dark"] .sidebar .nav-link:not(.active):hover {
  color: var(--bs-body-color);
}

/* Prevent toggle button overlap by reserving width and aligning */
.sidebar .toggle-btn {
  width: 2rem;
  height: 2rem;
  padding: 0;
}

/* Position the collapsed user flyout neatly */
.sidebar .user-flyout {
  min-width: 180px;
  transform: translateY(-8px);
  z-index: 1045;
}

.sidebar.collapsed .nav-link {
  justify-content: center;
}
.sidebar.collapsed .brand-toggle { justify-content: center; padding-left: 0; padding-right: 0; }

.sidebar.collapsed .nav-link > *:not(:first-child) {
  display: none;
}

.sidebar.collapsed .dropdown-toggle::after {
  display: none;
}

/* Reduce horizontal padding when collapsed so total outer width fits */
.sidebar.collapsed {
  padding-left: 0.5rem;
  padding-right: 0.5rem;
}

/* App shell uses flex so the sidebar and main sit side-by-side without overlap */

.app-shell {
  display: flex;
  flex: 1 1 auto; /* fill the available space between header/footer */
  min-height: 0; /* allow children to size correctly when using flex */
  /* allow vertical scrolling inside the shell but prevent horizontal overflow */
  overflow-x: hidden;
  overflow-y: auto; /* ensure scrolling happens inside the shell so the footer stays visible */
}

.app-shell .sidebar {
  flex: 0 0 280px; /* default sidebar width */
  box-sizing: border-box;
  min-width: 0;
  max-width: 280px;
}

.app-shell .sidebar.collapsed {
  flex: 0 0 70px; /* collapsed width */
  max-width: 70px;
}

/* Sidebar header button visuals */
.sidebar .btn.btn-outline-secondary.btn-sm {
  border-color: rgba(2, 6, 23, 0.12);
}
.sidebar .btn.btn-outline-secondary.btn-sm:hover {
  background-color: rgba(2, 6, 23, 0.04);
}

.app-shell main {
  flex: 1 1 auto;
  min-height: 0; /* important so children using height:100% don't overflow */
  min-width: 0; /* allow the main column to shrink below its content to avoid overflow */
}

/* make sure main and shell never exceed viewport width */
.app-shell, .app-shell main, .site-footer {
  max-width: 100vw;
  box-sizing: border-box;
  overflow-x: hidden;
}

/* Ensure sidebar content/flyouts can show; still avoid horizontal scroll in app-shell */
.sidebar {
  overflow: visible;
}

/* Footer should sit above the sidebar if any overlap happens */
.site-footer {
  position: relative;
  z-index: 1100;
}

@media (max-width: 767.98px) {
  /* On small screens the sidebar becomes fixed and overlays content when open */
  .app-shell .sidebar {
    position: fixed;
    left: 0;
    top: 0;
    bottom: 0;
    width: 280px;
    flex: 0 0 280px;
    z-index: 1030;
  }

  .app-shell .sidebar.collapsed {
    width: 70px;
    flex: 0 0 70px;
  }

  .app-shell main {
    /* keep main full width beneath a fixed sidebar on mobile */
    flex: 1 1 auto;
    margin-left: 0;
  }
}

/* If the collapsed floating user menu appears on small screens, force it to align inside the viewport
   The inline style uses left, so we override with !important here for narrow viewports to prevent overflow */
@media (max-width: 420px) {
  .dropdown-menu.show.shadow {
    left: auto !important;
    right: 8px !important;
    min-width: 140px !important;
  }
}

/* Specific override for the collapsed sidebar element (matches the exact class list used)
   This forces overflow-x hidden even if an inline style sets overflow-x:auto. */
.d-flex.flex-column.flex-shrink-0.p-3.bg-light.sidebar.collapsed {
  overflow-x: hidden !important;
}

/* Library / Netflix-like rows */
.section-row {
  scroll-behavior: smooth;
  -webkit-overflow-scrolling: touch;
  padding-bottom: 6px;
}

/* Add subtle fade shadows at the scroll edges */
.section-row {
  mask-image: linear-gradient(to right, transparent 0, black 24px, black calc(100% - 24px), transparent 100%);
}

.library-header input.form-control::placeholder { opacity: .7; }
.library-header .form-select { min-width: 160px; }
/* Outline-primary style parity for Library actions */
.btn-outline-primary.active,
.btn-outline-primary:active {
  color: #fff !important;
  background-color: var(--brand) !important;
  border-color: var(--brand) !important;
}

/* Better aligned search icon */
.library-header .search-wrap { position: relative; }
.library-header .search-wrap .search-icon {
  position: absolute;
  left: 10px;
  top: 50%;
  transform: translateY(-50%);
  pointer-events: none;
  opacity: .6;
}

.book-card {
  position: relative;
  display: inline-block;
}

.book-poster {
  background-size: cover;
  background-position: center;
  display: flex;
  align-items: flex-end;
  padding: 10px;
  color: white;
  box-shadow: 0 6px 18px rgba(2,6,23,0.08);
  transition: transform 200ms ease, box-shadow 200ms ease, filter 200ms ease;
}
.book-card:hover .book-poster {
  transform: translateY(-6px) scale(1.02);
  box-shadow: 0 14px 40px rgba(2,6,23,0.18);
  filter: saturate(1.02);
}

.book-poster-meta {
  width: 100%;
  padding-bottom: 6px;
  text-shadow: 0 2px 8px rgba(0,0,0,0.6);
}
.book-title { font-weight: 600; }
.book-author { opacity: 0.95; }

.book-overlay {
  pointer-events: none;
  position: absolute;
  inset: 0;
  display: flex;
  align-items: end;
  justify-content: center;
  gap: 8px;
  padding: 10px;
  transition: opacity 160ms ease, background 160ms ease;
  opacity: 0;
}
.book-card:hover .book-overlay,
.book-card:focus-within .book-overlay {
  opacity: 1;
  pointer-events: auto;
  background: linear-gradient(180deg, rgba(0,0,0,0) 40%, rgba(0,0,0,0.45) 100%);
}

.carousel-control {
  width: 36px;
  height: 36px;
  padding: 0;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

@media (max-width: 767.98px) {
  .book-card { min-width: 120px !important; }
  .book-poster { height: 180px !important; }
}

/* Grid view refinements */
.grid-books .book-card { display: block; width: 100%; }
.grid-books .book-poster { height: 280px; }
.grid-books .book-card:hover .book-poster { transform: translateY(-4px) scale(1.01); }
.grid-books .book-overlay { align-items: flex-end; }

/* --- Sidebar tweaks (additional) --- */
/* Hide the middle menu divider when collapsed */
.sidebar.collapsed .menu-divider { display: none; }
/* Keep the top brand divider visible at all times */
.sidebar .menu-divider-top { display: block; }

/* Remove any unwanted borders/backgrounds from user button area */
.sidebar .dropdown > .dropdown-toggle {
  box-shadow: none !important;
  border: 0 !important;
  background: transparent !important;
}

/* Simple avatar circle with initials (used when no profile image) */
.avatar-circle {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  border-radius: 999px;
  font-size: 0.9rem;
  font-weight: 600;
  color: #fff;
  background: linear-gradient(180deg, #a7287f, #b14770);
}

